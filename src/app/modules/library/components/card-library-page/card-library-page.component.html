<div class="container-lg">
  <div class="text-center mt-2xs mb-s">
    <nav mat-tab-nav-bar [tabPanel]="tabPanel" mat-align-tabs="center" [mat-stretch-tabs]="false">
      @for (cardClass of config.cardClasses; track cardClass) {
        <a mat-tab-link [routerLink]="['/library/cards', cardClass | lowercase]" routerLinkActive [active]="m0.isActive" #m0="routerLinkActive">{{ cardClass | titlecase }}</a>
      }
    </nav>
  </div>

  <mat-tab-nav-panel #tabPanel>
    <div class="d-flex flex-wrap justify-content-center">
      @for (ref of cardComponents$ | async; track ref) {
        <button
          hs-entity-button
          contentType="card"
          (click)="selectedCard$.next(ref.instance.data); openCardOverlay(); button._elementRef.nativeElement.blur()"
          class="mb-xs"
          #button
        >
          <ng-container *ngComponentOutlet="ref.componentType" />
        </button>
      }
    </div>
  </mat-tab-nav-panel>
</div>

<ng-template #cardOverlay>
  @if (selectedCard$ | async; as card) {
    <hs-entity-wrapper contentType="card" [scale]="selectedCardScale$ | async" class="hs-entity-overlay-shadow">
      @switch (card.type) {
        @case (CardType.MINION) {
          <hs-minion [data]="card" />
        }
        @case (CardType.SPELL) {
          <hs-spell [data]="card" />
        }
        @case (CardType.WEAPON) {
          <hs-weapon [data]="card" />
        }
      }
    </hs-entity-wrapper>
  }
</ng-template>
